<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings Submenu Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { border: 1px solid #ccc; padding: 15px; margin: 10px 0; }
        .nav-link { display: inline-block; padding: 8px 12px; margin: 5px; background: #f0f0f0; cursor: pointer; }
        .nav-link.active { background: #007bff; color: white; }
        .tab-pane { display: none; padding: 20px; border: 1px solid #ddd; margin-top: 10px; }
        .tab-pane.active { display: block; }
        .status { padding: 10px; background: #e7f3ff; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Settings Submenu Functionality Test</h1>
    
    <div class="status" id="status">Ready to test...</div>
    
    <div class="test-section">
        <h2>Simulated Submenu Links</h2>
        <a href="/setup" class="nav-link" data-tab="admins">Admin Accounts</a>
        <a href="/setup" class="nav-link" data-tab="org">Organization</a>
        <a href="/setup" class="nav-link" data-tab="email">Email Settings</a>
        <a href="/setup" class="nav-link" data-tab="data">Your Data</a>
    </div>
    
    <div class="test-section">
        <h2>Tab Content</h2>
        <div class="tab-pane active" id="tab-admins">
            <h3>Admin Accounts Tab</h3>
            <p>This is the admin accounts content.</p>
        </div>
        <div class="tab-pane" id="tab-org">
            <h3>Organization Tab</h3>
            <p>This is the organization content.</p>
        </div>
        <div class="tab-pane" id="tab-email">
            <h3>Email Settings Tab</h3>
            <p>This is the email settings content.</p>
        </div>
        <div class="tab-pane" id="tab-data">
            <h3>Your Data Tab</h3>
            <p>This is the your data content.</p>
        </div>
    </div>

    <script>
        // Global function to show settings tab (same as in setup.html)
        function showSettingsTab(tabName) {
            console.log('showSettingsTab called with:', tabName);
            
            // Hide all tab panes
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            // Show the selected tab
            const targetTab = document.getElementById('tab-' + tabName);
            if (targetTab) {
                targetTab.classList.add('active');
                console.log('Activated tab:', 'tab-' + tabName);
            } else {
                console.error('Tab not found:', 'tab-' + tabName);
            }
            
            // Update submenu active states
            document.querySelectorAll('.nav-link').forEach(link => {
                const linkTab = link.getAttribute('data-tab');
                if (linkTab === tabName) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
            
            // Update status
            document.getElementById('status').textContent = `Switched to: ${tabName} tab`;
        }

        // Make function globally available
        window.showSettingsTab = showSettingsTab;

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, setting up submenu links...');
            
            // Set up submenu links (same logic as base.html)
            const settingsSubmenuLinks = document.querySelectorAll('.nav-link[data-tab]');
            console.log('Found submenu links:', settingsSubmenuLinks.length);
            
            settingsSubmenuLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const tabName = this.getAttribute('data-tab');
                    console.log('Clicked submenu link:', tabName);
                    
                    if (tabName) {
                        // Simulate being on settings page
                        if (window.location.pathname === '/setup' || true) { // Always true for this test
                            // Prevent navigation and switch tabs directly
                            e.preventDefault();
                            
                            // Call the tab switching function
                            if (typeof window.showSettingsTab === 'function') {
                                window.showSettingsTab(tabName);
                            }
                            
                            return false;
                        }
                    }
                });
            });
            
            // Set initial tab
            showSettingsTab('admins');
            console.log('Setup complete!');
        });
    </script>
</body>
</html>