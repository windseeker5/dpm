{% extends "base.html" %}
{% block title %}Pass {{ hockey_pass.pass_code }}{% endblock %}

{% block content %}


    <!-- QR Code Display -->
 
    <div class="qr-wrapper">
        <img src="data:image/png;base64,{{ qr_data }}" alt="QR Code" class="qr-image" />
    </div>
      
    

    <div class="pass-history-wrapper">

        <h3 class="center-align">History</h3>
      
        <div class="history-table-container">
          <table class="highlight centered history-table">
            <thead>
              <tr>
                <th>Event</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Created</td><td>{{ history.created }}</td></tr>
              <tr><td>Paid</td><td>{{ history.paid or '‚ùå Not Paid' }}</td></tr>
              {% for date in history.redemptions %}
                <tr><td>Redeem #{{ loop.index }}</td><td>{{ date }}</td></tr>
              {% endfor %}
              {% if history.expired %}
                <tr><td>Expired</td><td>{{ history.expired }}</td></tr>
              {% endif %}
            </tbody>
          </table>
        </div>
      </div>
      
      



    <!-- Admin Redeem Form -->
    {% if is_admin and hockey_pass.games_remaining > 0 %}
    <div class="center-align" style="margin-top: 30px;">
        <form action="{{ url_for('redeem_pass', pass_code=hockey_pass.pass_code) }}" method="POST">
            <button type="submit" class="btn waves-effect">
              Redeem A Game
            </button>
        </form>
    </div>
    {% endif %}




    <!-- Unpaid Banner -->
    {% if not hockey_pass.paid_ind %}

    <div class="unpaid-warning z-depth-1">
        <p class="warning-title">‚ùó This pass is <strong>not paid yet</strong></p>
        <p class="warning-info">Send an Interac e-Transfer to: <strong>email@gmail.com</strong></p>
      
        <form action="{{ url_for('create_checkout_session', pass_id=hockey_pass.id) }}" method="POST" style="margin-top: 10px;">
          <button class="btn pay-btn waves-effect waves-light" type="submit">
            üí≥ Pay with Credit Card
          </button>
        </form>
      </div>
      
    {% endif %}
    

 
{% endblock %}
