{% extends "base.html" %}
{% block title %}Pass Details{% endblock %}

{% block content %}
<div class="container-xl mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">

      <!-- ✅ QR Code Lightbox -->
      <div class="text-center mb-4">
        <a href="data:image/png;base64,{{ qr_data }}" data-bs-toggle="modal" data-bs-target="#qrModal">
          <img src="data:image/png;base64,{{ qr_data }}" alt="QR Code" class="img-thumbnail" style="max-width: 180px;" />
        </a>
        <div class="small text-muted">Click to enlarge QR</div>
      </div>

      <!-- ✅ Owner Card Block -->
      {% include 'email_blocks/owner_card_inline.html' %}

      <!-- ✅ Action Button (Admin only) -->
      {% if is_admin %}
        <div class="text-center my-3">
          <a href="{{ url_for('edit_pass', pass_code=hockey_pass.pass_code) }}" class="btn btn-outline-secondary">
            <i class="ti ti-pencil"></i> Edit
          </a>
        </div>
      {% endif %}

      <!-- ✅ History Table Block -->
      {% if history %}
        <div class="mt-4">
          {% include 'email_blocks/history_table_inline.html' %}
        </div>
      {% endif %}

      <!-- ✅ Additional Notes -->
      {% if hockey_pass.notes %}
        <div class="alert alert-info mt-4">
          <strong>Note:</strong> {{ hockey_pass.notes }}
        </div>
      {% endif %}

    </div>
  </div>
</div>

<!-- ✅ Modal Lightbox -->
<div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered text-center">
    <div class="modal-content p-3">
      <img src="data:image/png;base64,{{ qr_data }}" class="img-fluid" style="max-width: 400px;" />
      <button type="button" class="btn-close position-absolute top-0 end-0 m-2" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
  </div>
</div>
{% endblock %}
