<div style="width: 100%; margin: 0 auto 30px; border: 1px solid #e2e8f0; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
  <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
    <thead style="background-color: #f2f2f2;">
      <tr>
        <th style="padding: 10px 14px; text-align: left; border-bottom: 1px solid #e2e8f0;">Activité</th>
        <th style="padding: 10px 14px; text-align: left; border-bottom: 1px solid #e2e8f0;">Date</th>
        <th style="padding: 10px 14px; text-align: left; border-bottom: 1px solid #e2e8f0;">Par</th>
      </tr>
    </thead>
    <tbody>
      <!-- Création -->
      <tr>
        <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">Création</td>
        <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">
          {{ history.created or "—" }}
        </td>
        <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">
          {{ history.created_by | trim_email if history.created_by else "—" }}
        </td>
      </tr>

      <!-- Paiement -->
      <tr>
        <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">Paiement</td>
        <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">
          {{ history.paid or '❌ Non payé' }}
        </td>
        <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">
          {{ history.paid_by | trim_email if history.paid_by else "—" }}
        </td>
      </tr>

      <!-- Redemptions -->
      {% if history.redemptions %}
        {% for r in history.redemptions %}
        <tr>
          <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">Activité #{{ loop.index }}</td>
          <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">{{ r.date }}</td>
          <td style="padding: 10px 14px; border-bottom: 1px solid #e2e8f0;">{{ r.by | trim_email }}</td>
        </tr>
        {% endfor %}
      {% endif %}

      <!-- Expiré -->
      {% if history.expired %}
      <tr>
        <td style="padding: 10px 14px;">Expiré</td>
        <td style="padding: 10px 14px;">{{ history.expired }}</td>
        <td style="padding: 10px 14px;">—</td>
      </tr>
      {% endif %}
    </tbody>
  </table>
</div>
