<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>{% block title %}Minipass Admin{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Favicons -->
  <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}">

  <!-- Tabler Core CSS -->
  <link href="{{ url_for('static', filename='tabler/css/tabler.min.css') }}" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='tabler/css/tabler-flags.min.css') }}" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='tabler/css/tabler-vendors.min.css') }}" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='tabler/css/demo.min.css') }}" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='tabler/icons/tabler-icons.min.css') }}" rel="stylesheet"/>


  {% block head %}{% endblock %}
</head>
<body>
<div class="page">



  <!-- Simple Navigation Bar -->
  <header class="navbar navbar-expand-md navbar-light bg-white border-bottom d-print-none">
    <div class="container-xl">


      <!-- Logo -->
      <a href="{{ url_for('dashboard') }}" class="navbar-brand d-flex align-items-center gap-2">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Minipass Logo" height="30" style="max-width: 120px;">
        <span class="fw-bold text-dark d-none d-md-inline">{{ ORG_NAME }}</span>
      </a>
      


      
      <!-- Admin Avatar & Name -->
      {% if session.get("admin") %}
      <div class="navbar-nav flex-row order-md-last align-items-center">
      
        <!-- Theme Toggle Button -->
        <div class="nav-item px-2">
          <a href="#" id="theme-toggle" class="nav-link px-0" title="Toggle dark mode" data-bs-toggle="tooltip">
            <i class="ti ti-moon theme-icon theme-light-only"></i>
            <i class="ti ti-sun theme-icon theme-dark-only" style="display: none;"></i>
          </a>
        </div>

      
        <!-- Admin Avatar & Name -->
        <div class="nav-item dropdown">
          <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown">
            <span class="avatar avatar-sm rounded-circle" style="background-image: url('https://www.gravatar.com/avatar/{{ session['admin']|lower|trim|encode_md5 }}?d=identicon')"></span>
            <div class="d-none d-xl-block ps-2">
              <div>{{ session['admin'] }}</div>
              <div class="text-muted small">Admin</div>
            </div>
          </a>
          <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
            <a href="{{ url_for('setup') }}" class="dropdown-item">
              <i class="ti ti-settings me-2"></i>Settings
            </a>
            <div class="dropdown-divider"></div>
            <a href="{{ url_for('logout') }}" class="dropdown-item text-danger">
              <i class="ti ti-logout me-2"></i>Logout
            </a>
          </div>
        </div>
      </div>
      {% endif %}
      


 
    </div>
  </header>

  <!-- Page content -->
  <div class="page-wrapper">
    <div class="page-body">
      <div class="container-xl">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }} alert-dismissible" role="alert">
                <div class="d-flex">
                  <div>{{ message }}</div>
                  <a class="btn-close" data-bs-dismiss="alert" aria-label="Close"></a>
                </div>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer footer-transparent d-print-none">
      <div class="container-xl text-center text-muted py-3">
        Â© 2025 <a href="https://minipass.me" class="text-muted">minipass.me</a> - All rights reserved.
      </div>
    </footer>
  </div>
</div>

<!-- Tabler Core JS -->
<script src="{{ url_for('static', filename='tabler/js/tabler.min.js') }}"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggleBtn = document.getElementById("theme-toggle");

    if (toggleBtn) {
      toggleBtn.addEventListener("click", function (e) {
        e.preventDefault();

        const body = document.body;
        const isDark = body.classList.toggle("theme-dark");

        // Toggle icon visibility
        const moonIcon = toggleBtn.querySelector(".theme-light-only");
        const sunIcon = toggleBtn.querySelector(".theme-dark-only");

        if (isDark) {
          moonIcon.style.display = "none";
          sunIcon.style.display = "inline";
        } else {
          moonIcon.style.display = "inline";
          sunIcon.style.display = "none";
        }
      });
    }
  });
</script>







{% block scripts %}{% endblock %}
</body>
</html>
